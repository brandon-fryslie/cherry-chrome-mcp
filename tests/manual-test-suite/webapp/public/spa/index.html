<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webapp 4: SPA</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        iframe {
            width: 100%;
            height: 400px;
            border: 2px solid #ccc;
            border-radius: 4px;
        }

        .nav-link {
            padding: 10px;
            margin-right: 10px;
            text-decoration: none;
            color: #333;
            border-bottom: 2px solid transparent;
        }

        .nav-link.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }
    </style>
</head>

<body>
    <div class="container">
        <a href="../index.html">‚Üê Back to Main Suite</a>
        <h1>SPA Navigation</h1>

        <nav class="card" style="margin-bottom: 20px;">
            <a href="#home" class="nav-link" id="link-home">Home</a>
            <a href="#settings" class="nav-link" id="link-settings">Settings</a>
            <a href="#frame" class="nav-link" id="link-frame">iFrame Integration</a>

            <!-- S5.1: New Tab -->
            <a href="../dashboard.html" target="_blank" class="btn" style="float: right; margin-top: -5px;">Open
                Dashboard (New Tab)</a>
        </nav>

        <main id="app-content">
            <!-- Dynamic Content Loaded Here -->
        </main>

        <!-- Templates -->
        <template id="view-home">
            <section class="card">
                <h2>Home View</h2>
                <p>Welcome to the SPA. This content is rendered client-side.</p>
                <div class="mt-20">
                    <p>Current Route: <code id="route-display">#home</code></p>
                    <button class="btn" onclick="window.location.hash = '#settings'">Go to Settings</button>
                </div>
            </section>
        </template>

        <template id="view-settings">
            <section class="card">
                <h2>Settings View</h2>
                <form>
                    <div class="form-group">
                        <label>Notification Email</label>
                        <input type="email" value="user@example.com">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" checked> Enable Alerts
                        </label>
                    </div>
                </form>
            </section>
        </template>

        <template id="view-frame">
            <section class="card">
                <h2>iFrame Content</h2>
                <p>Below is an embedded version of the Forms webapp.</p>
                <!-- S6.3: iFrame -->
                <iframe src="../forms.html" title="Embedded Forms"></iframe>
            </section>
        </template>
    </div>

    <script>
        // S5.2: Simple SPA Router
        function render() {
            const hash = window.location.hash || '#home';
            const content = document.getElementById('app-content');
            const items = document.querySelectorAll('.nav-link');

            // Update Active Link
            items.forEach(link => {
                if (link.getAttribute('href') === hash) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            // Update Content
            content.innerHTML = '';
            const viewId = 'view-' + hash.substring(1); // remove #
            const template = document.getElementById(viewId);

            if (template) {
                const clone = template.content.cloneNode(true);
                content.appendChild(clone);

                // Update dynamic bits in templates
                if (hash === '#home') {
                    document.getElementById('route-display').textContent = hash;
                }
            } else {
                content.innerHTML = '<p>404 Not Found</p>';
            }
        }

        window.addEventListener('hashchange', render);
        window.addEventListener('DOMContentLoaded', render);
    </script>
</body>

</html>